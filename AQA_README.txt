## –ú–µ—Ç—Ä–∏–∫–∏ –∏ –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

–î–æ–±–∞–≤–∏–º —Å–µ–∫—Ü–∏—é –æ –º–µ—Ç—Ä–∏–∫–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ –∏ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–π.
- **BLEU (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞)**: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç n-gram —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è. –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ unit-—Ç–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —É–ø—Ä–æ—â—ë–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é unigram+brevity penalty. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏ –≤ —Ç–µ—Å—Ç–∞—Ö-–ø—Ä–∏–º–µ—Ä–∞—Ö:
  - –î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è: BLEU >= 0.9
  - –î–ª—è –ø—Ä–∏–µ–º–ª–µ–º–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞: BLEU >= 0.25

- **ROUGE-L**: –±–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ LCS (longest common subsequence). –ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
  - –•–æ—Ä–æ—à–∏–π –ø–µ—Ä–µ–≤–æ–¥: ROUGE-L F1 >= 0.6
  - –ß–∞—Å—Ç–∏—á–Ω–∞—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å —Å–º—ã—Å–ª–∞: ROUGE-L F1 >= 0.3

- **Semantic similarity (BERTScore / TF-IDF cosine)**: –¥–ª—è –≥—Ä—É–±–æ–π –æ—Ü–µ–Ω–∫–∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –±–ª–∏–∑–æ—Å—Ç–∏. –í unit-—Ç–µ—Å—Ç–∞—Ö —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ TF-IDF + cosine –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ `scikit-learn`, –∏–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Jaccard token overlap.
  - –•–æ—Ä–æ—à–∞—è —Å–µ–º–∞–Ω—Ç–∏–∫–∞: similarity >= 0.8 (–¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π —Å BERTScore)
  - –í —É–ø—Ä–æ—â—ë–Ω–Ω–æ–º —Ç–µ—Å—Ç–µ –æ–∂–∏–¥–∞–µ—Ç—Å—è similarity >= 0.4

- **Length ratio**: –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –ø–µ—Ä–µ–≤–æ–¥–∞ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—Ä–µ–∑–∫–∏/—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.
  - –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω: 0.7 ‚Äî 1.3

- **Language detection**: –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–µ—Ä–µ–≤–æ–¥—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ü–µ–ª–µ–≤–æ–º—É —è–∑—ã–∫—É (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `langdetect`, —Ç–µ—Å—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –µ—Å–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞).

- **Toxicity / Safety**: –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —á–µ–∫–µ—Ä—ã —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏.

–ö–∞–∂–¥–∞—è –º–µ—Ç—Ä–∏–∫–∞ –ø–æ–∫—Ä—ã—Ç–∞ unit-—Ç–µ—Å—Ç–∞–º–∏ –≤ `tests/unit/test_metrics.py`. –¢–µ—Å—Ç—ã —Å–¥–µ–ª–∞–Ω—ã —Ç–∞–∫, —á—Ç–æ–±—ã –±—ã—Ç—å –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–º–∏ –±–µ–∑ —Ç—è–∂—ë–ª—ã—Ö —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚Äî –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ `scikit-learn` —Ç–æ—á–Ω–æ—Å—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –æ—Ü–µ–Ω–∫–∏ —É–ª—É—á—à–∞–µ—Ç—Å—è.

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∏ UI-—Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç, —á—Ç–æ –º–µ—Ç—Ä–∏–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∏ —á—Ç–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (–∫–ª–∞—Å—Å `.metric-success` / `.metric-warning`) –º–µ–Ω—è—é—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ä–æ–≥–∞.
# üìã –ü–û–õ–ù–û–ï –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ - AI Translator & Critic

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —é–Ω–∏—Ç-—Ç–µ—Å—Ç–∞—Ö –∏ UI-—Ç–µ—Å—Ç–∞—Ö –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "AI Translator & Critic".

---

## üìë –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (pytest)](#—é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã)
3. [UI-—Ç–µ—Å—Ç—ã (Cypress)](#ui-—Ç–µ—Å—Ç—ã)
4. [–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤](#–∑–∞–ø—É—Å–∫-—Ç–µ—Å—Ç–æ–≤)
5. [–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
6. [Troubleshooting](#troubleshooting)

---

## üìå –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ {#–≤–≤–µ–¥–µ–Ω–∏–µ}

### –ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ?

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–≥–æ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç—Å—è.

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤ –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ:

| –¢–∏–ø | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-----|-----------|-----------|------------------|
| **–Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã** | pytest | –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –±—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å |
| **UI-—Ç–µ—Å—Ç—ã** | Cypress | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ |

### –¢–µ—Å—Ç–æ–≤–∞—è –ø–∏—Ä–∞–º–∏–¥–∞

```
        /\
       /  \      UI-—Ç–µ—Å—Ç—ã (5% —Ç–µ—Å—Ç–æ–≤)
      /    \     - –ú–µ–¥–ª–µ–Ω–Ω—ã–µ
     /  UI  \    - –î–æ—Ä–æ–≥–∏–µ
    /________\
    
    /        \
   /          \   Integration Tests (15% —Ç–µ—Å—Ç–æ–≤)
  /   INTEG.   \  - –°—Ä–µ–¥–Ω–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
 /_____________\
 
 /              \
/    UNIT        \   Unit Tests (80% —Ç–µ—Å—Ç–æ–≤)
/__________________\ - –ë—ã—Å—Ç—Ä—ã–µ
                      - –î–µ—à–µ–≤—ã–µ
```

–ú—ã –¥–æ–ª–∂–Ω—ã –ø–∏—Å–∞—Ç—å **–º–Ω–æ–≥–æ** —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–≤ –∏ **–º–µ–Ω—å—à–µ** UI-—Ç–µ—Å—Ç–æ–≤.

---

## üß™ –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (pytest) {#—é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã}

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
tests/
‚îú‚îÄ‚îÄ conftest.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Ñ–∏–∫—Å—Ç—É—Ä—ã pytest
‚îî‚îÄ‚îÄ unit/
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îî‚îÄ‚îÄ test_app.py       # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

### –ß—Ç–æ —Ç–∞–∫–æ–µ pytest?

**pytest** - —ç—Ç–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –Ω–∞ Python.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü—Ä–æ—Å—Ç–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–æ–≤
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –æ–± –æ—à–∏–±–∫–∞—Ö
- –ë–æ–ª—å—à–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –∏ –ø–ª–∞–≥–∏–Ω—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (conftest.py)

**conftest.py** —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∏–∫—Å—Ç—É—Ä—ã - —ç—Ç–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤.

#### –§–∏–∫—Å—Ç—É—Ä–∞ 1: `client`

```python
@pytest.fixture
def client():
    """Flask —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç"""
    app.config['TESTING'] = True
    with app.test_client() as test_client:
        yield test_client
```

**–ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
- –ë–ï–ó –∑–∞–ø—É—Å–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
```python
def test_something(client):  # –ü–µ—Ä–µ–¥–∞–µ–º client –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä
    response = client.get('/')
    assert response.status_code == 200
```

#### –§–∏–∫—Å—Ç—É—Ä–∞ 2: `mock_api_key`

```python
@pytest.fixture
def mock_api_key(monkeypatch):
    """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥–¥–µ–ª—å–Ω–æ–≥–æ API –∫–ª—é—á–∞"""
    monkeypatch.setenv('MENTORPIECE_API_KEY', 'test-key-12345')
```

**–ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ API –∫–ª—é—á–∞

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
```python
def test_with_api_key(mock_api_key):
    api_key = os.getenv('MENTORPIECE_API_KEY')
    assert api_key == 'test-key-12345'
```

#### –§–∏–∫—Å—Ç—É—Ä–∞ 3: `mock_api_response`

```python
@pytest.fixture
def mock_api_response():
    """–ü—Ä–∏–º–µ—Ä—ã –º–æ–∫-–æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç API"""
    return {
        'successful_translation': {...},
        'successful_verdict': {...},
        ...
    }
```

**–ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
- –ò–∑–±–µ–≥–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –ö–ª–∞—Å—Å—ã —Ç–µ—Å—Ç–æ–≤ –≤ test_app.py

#### –ö–ª–∞—Å—Å 1: TestAPIKeyLoading

```python
class TestAPIKeyLoading:
    def test_api_key_loaded_from_env(self, mock_api_key):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ API –∫–ª—é—á–∞"""
        ...
    
    def test_api_key_missing_handling(self):
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∫–ª—é—á–∞"""
        ...
```

**–¢–µ—Å—Ç–∏—Ä—É–µ—Ç:**
‚úÖ –ß—Ç–æ API –∫–ª—é—á –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚úÖ –ß—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–ª—é—á–∞

#### –ö–ª–∞—Å—Å 2: TestCallLLMFunction

```python
class TestCallLLMFunction:
    @patch('app.requests.post')
    def test_successful_llm_call(self, mock_post, ...):
        """–£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ API"""
        ...
    
    @patch('app.requests.post')
    def test_llm_call_with_timeout_error(self, mock_post, ...):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–π–º–∞—É—Ç–∞"""
        ...
```

**–¢–µ—Å—Ç–∏—Ä—É–µ—Ç:**
‚úÖ –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ call_llm
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ API (—Ç–∞–π–º–∞—É—Ç, ConnectionError, 401)

**–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–µ–º `@patch` –¥–ª—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è requests.post

#### –ö–ª–∞—Å—Å 3: TestHTTPRoutes

```python
class TestHTTPRoutes:
    def test_get_root_route(self, client):
        """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GET /"""
        ...
    
    @patch('app.call_llm')
    def test_post_with_valid_data(self, mock_call_llm, ...):
        """–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ POST —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"""
        ...
```

**–¢–µ—Å—Ç–∏—Ä—É–µ—Ç:**
‚úÖ GET / –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–æ—Ä–º—É
‚úÖ POST / –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç call_llm –¥–≤–∞–∂–¥—ã
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –≤ —Ñ–æ—Ä–º–µ

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ (@patch)

```python
@patch('app.requests.post')
def test_something(mock_post):
    # mock_post - —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–º–µ–Ω—è–µ—Ç requests.post
    
    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —á—Ç–æ –¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å mock
    mock_response = MagicMock()
    mock_response.status_code = 200
    mock_response.json.return_value = {'response': 'test'}
    mock_post.return_value = mock_response
    
    # –í—ã–∑—ã–≤–∞–µ–º –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç requests.post
    result = call_llm('test-model', 'test-prompt')
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    assert result == 'test'
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∫ –±—ã–ª –≤—ã–∑–≤–∞–Ω mock
    mock_post.assert_called_once()
    assert mock_post.call_args[0][0] == 'https://api.mentorpiece.org/...'
```

**–ó–∞—á–µ–º –Ω–∞–º –Ω—É–∂–Ω–æ –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ?**

1. **–°–∫–æ—Ä–æ—Å—Ç—å** - –Ω–µ –¥–µ–ª–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ —Å–µ—Ç–∏
2. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –Ω–µ –∑–∞–≤–∏—Å–∏–º—ã –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API
3. **–°—Ç–æ–∏–º–æ—Å—Ç—å** - –Ω–µ —Ç—Ä–∞—Ç–∏–º —Ç–æ–∫–µ–Ω—ã AI
4. **–ö–æ–Ω—Ç—Ä–æ–ª—å** - –º–æ–∂–µ–º —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ª—é–±—ã–µ –æ—à–∏–±–∫–∏

---

## üé® UI-—Ç–µ—Å—Ç—ã (Cypress) {#ui-—Ç–µ—Å—Ç—ã}

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
cypress/
‚îú‚îÄ‚îÄ cypress.config.js     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Cypress
‚îî‚îÄ‚îÄ e2e/
    ‚îî‚îÄ‚îÄ translator_critic.cy.js  # UI —Ç–µ—Å—Ç—ã
```

### –ß—Ç–æ —Ç–∞–∫–æ–µ Cypress?

**Cypress** - —ç—Ç–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è UI —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–∏—à–µ—Ç—Å—è –Ω–∞ JavaScript
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –õ–µ–≥–∫–æ –æ—Ç–ª–∞–¥–∏—Ç—å
- –û—Ç–ª–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Cypress

| –ö–æ–º–∞–Ω–¥–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ü—Ä–∏–º–µ—Ä |
|---------|-----------|--------|
| `cy.visit()` | –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É | `cy.visit('/')` |
| `cy.get()` | –ù–∞—Ö–æ–¥–∏—Ç —ç–ª–µ–º–µ–Ω—Ç | `cy.get('#id')` |
| `cy.contains()` | –ù–∞—Ö–æ–¥–∏—Ç –ø–æ —Ç–µ–∫—Å—Ç—É | `cy.contains('Button')` |
| `.type()` | –í–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç | `.type('Hello')` |
| `.click()` | –ù–∞–∂–∏–º–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç | `.click()` |
| `.select()` | –í—ã–±–∏—Ä–∞–µ—Ç –æ–ø—Ü–∏—é | `.select('Option')` |
| `.should()` | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏–µ | `.should('be.visible')` |
| `cy.intercept()` | –ú–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã | `cy.intercept('GET', '/api', {})` |

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞ Cypress

```javascript
describe('Group of tests', () => {
  // –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –ö–ê–ñ–î–´–ú —Ç–µ—Å—Ç–æ–º
  beforeEach(() => {
    cy.visit('/');
  });

  // –û—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç
  it('Should do something', () => {
    // –¢–µ—Å—Ç–æ–≤—ã–π –∫–æ–¥
  });

  // –ï—â–µ –æ–¥–∏–Ω —Ç–µ—Å—Ç
  it('Should do something else', () => {
    // –¢–µ—Å—Ç–æ–≤—ã–π –∫–æ–¥
  });
});
```

### –¢–µ—Å—Ç—ã –≤ translator_critic.cy.js

#### –¢–µ—Å—Ç 1: –£—Å–ø–µ—à–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥ –∏ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

```javascript
it('–î–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –∏ –æ—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞', () => {
  // 1. –ú–æ–∫–∏—Ä—É–µ–º API –∑–∞–ø—Ä–æ—Å—ã
  cy.intercept('POST', 'https://api.mentorpiece.org/...', (req) => {
    if (req.body.model_name === 'Qwen/...') {
      req.reply({
        statusCode: 200,
        body: { response: 'Mocked Translation: ...' }
      });
    }
  }).as('apiRequest');
  
  // 2. –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
  cy.get('#original_text').type('–°–æ–ª–Ω—Ü–µ —Å–≤–µ—Ç–∏—Ç.');
  cy.get('#target_language').select('–ê–Ω–≥–ª–∏–π—Å–∫–∏–π');
  
  // 3. –ù–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É
  cy.contains('button', '–ü–µ—Ä–µ–≤–µ—Å—Ç–∏').click();
  
  // 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  cy.contains('Mocked Translation: ...').should('be.visible');
  cy.wait('@apiRequest');
});
```

**–ß—Ç–æ —ç—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç:**
‚úÖ –§–æ—Ä–º–∞ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –ó–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ API
‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

#### –¢–µ—Å—Ç 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ API

```javascript
it('–î–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É API 500', () => {
  // –ú–æ–∫–∏—Ä—É–µ–º –æ—à–∏–±–∫—É 500
  cy.intercept('POST', 'https://api.mentorpiece.org/...', {
    statusCode: 500,
    body: { error: 'Internal Server Error' }
  });
  
  // –ó–∞–ø–æ–ª–Ω—è–µ–º –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É
  cy.get('#original_text').type('Test');
  cy.contains('button', '–ü–µ—Ä–µ–≤–µ—Å—Ç–∏').click();
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
  cy.get('body').should('contain', '–æ—à–∏–±–∫–∞');
});
```

**–ß—Ç–æ —ç—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç:**
‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ API
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
‚úÖ –§–æ—Ä–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

#### –¢–µ—Å—Ç 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Ñ–æ—Ä–º–µ

```javascript
it('–î–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–µ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏', () => {
  // –ú–æ–∫–∏—Ä—É–µ–º API
  cy.intercept('POST', 'https://api.mentorpiece.org/...', {...});
  
  // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
  const testText = '–¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç';
  cy.get('#original_text').type(testText);
  cy.get('#target_language').select('–ù–µ–º–µ—Ü–∫–∏–π');
  
  // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º
  cy.contains('button', '–ü–µ—Ä–µ–≤–µ—Å—Ç–∏').click();
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Å—Ç–∞–ª–∏—Å—å
  cy.get('#original_text').should('have.value', testText);
  cy.get('#target_language').should('have.value', '–ù–µ–º–µ—Ü–∫–∏–π');
});
```

**–ß—Ç–æ —ç—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç:**
‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —á—Ç–æ –æ–Ω –≤–≤–æ–¥–∏–ª
‚úÖ –£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É–ª—É—á—à–µ–Ω–æ

### –ú–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (cy.intercept)

```javascript
// –ë–∞–∑–æ–≤–∞—è —Ñ–æ—Ä–º–∞
cy.intercept('METHOD', 'URL', responseBody)

// –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π
cy.intercept('METHOD', 'URL', (req) => {
  // req —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–ø—Ä–æ—Å–µ
  // req.body - —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON)
  // req.headers - –∑–∞–≥–æ–ª–æ–≤–∫–∏
  // req.url - URL
  
  // –ú—ã –º–æ–∂–µ–º –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –æ—Ç–≤–µ—Ç
  req.reply({
    statusCode: 200,
    body: { /* response body */ }
  });
}).as('aliasName'); // –î–∞–µ–º –∏–º—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ cy.wait()
```

**–ü—Ä–∏–º–µ—Ä —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –º–æ–¥–µ–ª–∏:**

```javascript
cy.intercept('POST', '/api/endpoint', (req) => {
  if (req.body.model_name === 'ModelA') {
    req.reply({ statusCode: 200, body: { response: 'A response' } });
  } else if (req.body.model_name === 'ModelB') {
    req.reply({ statusCode: 200, body: { response: 'B response' } });
  }
}).as('apiCall');
```

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ {#–∑–∞–ø—É—Å–∫-—Ç–µ—Å—Ç–æ–≤}

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#### –î–ª—è —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–≤:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ pytest —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
pytest --version
```

#### –î–ª—è UI-—Ç–µ—Å—Ç–æ–≤:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Node.js –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)
npm install

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ cypress —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
npx cypress --version
```

### –ó–∞–ø—É—Å–∫ —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–≤

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã:

```bash
pytest tests/ -v
```

**–§–ª–∞–≥–∏:**
- `-v` (verbose) - –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥
- `-s` - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å print() –≤—ã–≤–æ–¥—ã
- `--tb=short` - –∫–æ—Ä–æ—Ç–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫
- `-x` - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
- `-k "test_name"` - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã —Å "test_name"

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã:

```bash
pytest tests/unit/ -v
```

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç:

```bash
pytest tests/unit/test_app.py::TestAPIKeyLoading::test_api_key_loaded_from_env -v
```

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –æ—Ç—á–µ—Ç–æ–º –æ –ø–æ–∫—Ä—ã—Ç–∏–∏:

```bash
pytest tests/ --cov=src --cov-report=html

# –û—Ç–∫—Ä–æ–µ—Ç –æ—Ç—á–µ—Ç –≤ HTML
open htmlcov/index.html
```

### –ó–∞–ø—É—Å–∫ UI-—Ç–µ—Å—Ç–æ–≤

#### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):

```bash
npx cypress open
```

–û—Ç–∫—Ä–æ–µ—Ç—Å—è Cypress Test Runner –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ:
- –í–∏–¥–µ—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
- –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç
- –°–ª–µ–¥–∏—Ç—å –∑–∞ —Ö–æ–¥–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- –î–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å–∏

#### Headless —Ä–µ–∂–∏–º (–¥–ª—è CI/CD):

```bash
npx cypress run
```

–ó–∞–ø—É—Å—Ç–∏—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã –≤ —Ñ–æ–Ω–µ –±–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞.

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ:

```bash
npx cypress run --browser chrome
npx cypress run --browser firefox
npx cypress run --browser edge
```

#### –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç —Ñ–∞–π–ª:

```bash
npx cypress run --spec "cypress/e2e/translator_critic.cy.js"
```

### npm —Å–∫—Ä–∏–ø—Ç—ã

–í —Ñ–∞–π–ª–µ package.json –µ—Å—Ç—å –≥–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:

```bash
npm test                    # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ pytest —Ç–µ—Å—Ç—ã
npm run test:unit          # –ó–∞–ø—É—Å—Ç–∏—Ç—å unit —Ç–µ—Å—Ç—ã
npm run test:coverage      # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –æ—Ç—á–µ—Ç–æ–º –æ –ø–æ–∫—Ä—ã—Ç–∏–∏
npm run cypress:open       # –û—Ç–∫—Ä—ã—Ç—å Cypress Test Runner
npm run cypress:run        # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –≤ headless —Ä–µ–∂–∏–º–µ
npm run cypress:run:chrome # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ Chrome
npm run cypress:headless   # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ headless —Ä–µ–∂–∏–º–µ
```

---

## üìä –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ {#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã}

### pytest —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–£—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```
tests/unit/test_app.py::TestAPIKeyLoading::test_api_key_loaded_from_env PASSED
tests/unit/test_app.py::TestAPIKeyLoading::test_api_key_missing_handling PASSED
tests/unit/test_app.py::TestCallLLMFunction::test_successful_llm_call PASSED
...

==================== 15 passed in 2.34s ====================
‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ!
```

–û—à–∏–±–∫–∞ –≤ —Ç–µ—Å—Ç–µ:

```
tests/unit/test_app.py::TestCallLLMFunction::test_llm_call_with_timeout_error FAILED

AssertionError: assert '–¢–∞–π–º–∞—É—Ç' in 'Some other text'
Expected '–¢–∞–π–º–∞—É—Ç' to be in the response text
```

**–ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**
1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ —Ç–µ—Å—Ç–∞
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç —Å–Ω–æ–≤–∞

### Cypress —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–£—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Test Runner:

```
‚úÖ AI Translator & Critic - –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
  ‚úÖ –î–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –∏ –æ—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ (2.5s)
  ‚úÖ –î–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫—É API 500 –∏ –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ (1.2s)
  ‚úÖ –î–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–µ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ (1.8s)
  ...

All tests passed! (5 specs, 0 failures)
```

–û—à–∏–±–∫–∞ –≤ —Ç–µ—Å—Ç–µ:

```
‚ùå –î–æ–ª–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥
  Error: Timed out waiting for element: 'Mocked Translation: ...'
```

**–ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –º–æ–∫-–æ—Ç–≤–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
2. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–∞ localhost:5000
3. –û—Ç–∫—Ä—ã—Ç—å Cypress Test Runner –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network tab –≤ DevTools

---

## üõ†Ô∏è Troubleshooting {#troubleshooting}

### –ü—Ä–æ–±–ª–µ–º–∞: pytest –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –º–æ–¥—É–ª—å app

**–û—à–∏–±–∫–∞:**
```
ModuleNotFoundError: No module named 'app'
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –í conftest.py —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..', 'src'))
```

### –ü—Ä–æ–±–ª–µ–º–∞: Cypress –≥–æ–≤–æ—Ä–∏—Ç —á—Ç–æ localhost:5000 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–û—à–∏–±–∫–∞:**
```
Cypress could not verify that your server is running
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ
python src/app.py

# –ò —á—Ç–æ –æ–Ω –∑–∞–ø—É—â–µ–Ω –Ω–∞ 5000 –ø–æ—Ä—Ç—É
# –ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ baseUrl –≤ cypress.config.js
```

### –ü—Ä–æ–±–ª–µ–º–∞: API –º–æ–∫ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

**–û—à–∏–±–∫–∞:**
```
Expected request to be made but it wasn't
```

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ—á–Ω–æ—Å—Ç—å URL
cy.intercept('POST', '**/v1/process-ai-request', {...})

// 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ wildcards
cy.intercept('POST', '**/api/**', {...})

// 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –º–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –î–û –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
beforeEach(() => {
  cy.visit('/');
  cy.intercept(...) // –ü–†–ê–í–ò–õ–¨–ù–û
});

it('test', () => {
  cy.get('#input').type('text');
  cy.intercept(...) // –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Å–ª–∏—à–∫–æ–º –ø–æ–∑–¥–Ω–æ
});
```

### –ü—Ä–æ–±–ª–µ–º–∞: Mock –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `side_effect` –≤ pytest:**

```python
@patch('app.requests.post')
def test_something(mock_post):
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
    mock_post.side_effect = [
        MagicMock(status_code=200, json=lambda: {'response': 'first'}),
        MagicMock(status_code=200, json=lambda: {'response': 'second'}),
    ]
    
    # –ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ –≤–µ—Ä–Ω–µ—Ç 'first'
    # –í—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ –≤–µ—Ä–Ω–µ—Ç 'second'
```

**–ò–ª–∏ –≤ Cypress:**

```javascript
cy.intercept('POST', '/api', (req) => {
  if (req.body.type === 'A') {
    req.reply({ response: 'A' });
  } else if (req.body.type === 'B') {
    req.reply({ response: 'B' });
  }
});
```

---

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### pytest –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [pytest.org](https://pytest.org)
- [pytest fixtures](https://pytest.org/en/stable/how-to-fixtures.html)
- [unittest.mock](https://docs.python.org/3/library/unittest.mock.html)

### Cypress –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [cypress.io](https://cypress.io)
- [cy.intercept()](https://docs.cypress.io/api/commands/intercept)
- [Best practices](https://docs.cypress.io/guides/references/best-practices)

### Flask —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [Flask Testing](https://flask.palletsprojects.com/en/2.3.x/testing/)
- [Test Client](https://flask.palletsprojects.com/en/2.3.x/testing/#the-test-client)

---

## üìù –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è QA —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤

- [ ] –Ø —É—Å—Ç–∞–Ω–æ–≤–∏–ª –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`pip install -r requirements.txt`)
- [ ] –Ø –∑–∞–ø—É—Å—Ç–∏–ª Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (`python src/app.py`)
- [ ] –Ø –∑–∞–ø—É—Å—Ç–∏–ª —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (`pytest tests/ -v`)
- [ ] –Ø –∑–∞–ø—É—Å—Ç–∏–ª Cypress (`npx cypress run`)
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ
- [ ] –Ø –ø—Ä–æ—á–∏—Ç–∞–ª –∫–æ–¥ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
- [ ] –Ø –ø–æ–Ω–∏–º–∞—é —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥—ã–π —Ç–µ—Å—Ç
- [ ] –Ø –º–æ–≥—É –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–æ–≤—ã–π —Ç–µ—Å—Ç —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 2024  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ê–≤—Ç–æ—Ä:** QA Automation Lead  
**–Ø–∑—ã–∫:** –†—É—Å—Å–∫–∏–π
